<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Site Simples com Chat</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 40px;
      background-color: #f4f4f4;
      text-align: center;
    }
    h1 {
      color: #333;
    }
    p {
      color: #666;
    }
  </style>
</head>
<body>
  <h1>Bem-vindo ao nosso site!</h1>
  <p>Este é um site simples com o chat inserido.</p>

  <!-- Script do chat -->
<script
src='//fw-cdn.com/12580031/4973524.js'
chat='true' widgetId='82f663aa-1d54-438b-a1cc-9b5c2238cf76'>
</script>

<script src="//fw-cdn.com/12580031/4973524.js" chat="true"></script>

<script>
  function initFreshchat() {
    if (window.fcWidget) {
      window.fcWidget.on("widget:loaded", function () {
        // Desativa o envio de arquivos
        window.fcWidget.setConfig({
          config: {
            fileUpload: false
          }
        });

        // Oculta o widget inicialmente
        window.fcWidget.hide();

        // Cria o formulário personalizado
        const formHtml = `
          <div id="fc-custom-form" style="position: fixed; bottom: 40px; right: 20px; width: 85%; max-width: 400px; height: auto; max-height: 90vh; background: white; border-radius: 4px; box-shadow: 0 4px 16px rgba(0,0,0,0.15); font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; z-index: 2147483647; overflow: hidden;">
            <div style="width:100%; height: 40px; background: #5d3e94; position: relative;">
              <button id="fc-close-form" style="
                position: absolute;
                top: 3px;
                right: 15px;
                background: transparent;
                border: none;
                color: white;
                font-size: 20px;
                font-weight: 400;
                cursor: pointer;
              ">x</button>
            </div>
            <img 
              src="https://cdn.shopify.com/s/files/1/0275/5385/7588/files/Logo_DropLatam_horizontal_dark.png?v=1715625177" 
              alt="Logo DropLatam" 
              style="max-width: 60%; height: auto; display: block; margin: 0 auto; margin-top: 20px;"
            >
            <div style="padding: 20px;">
              <div style="font-size: 16px; font-weight: 400; color: #1f2937; margin-bottom: 25px; margin-top: 0px; text-align: center;">Informe seus dados abaixo <br> antes de iniciar o atendimento.</div>

              <div style="margin-bottom: 16px;">
                <label for="fc-name" style="display: block; font-size: 14px; color: #374151; margin-bottom: 6px;"><strong>Nome</strong></label>
                <input 
                  id="fc-name" 
                  type="text" 
                  placeholder="Coloque aqui seu NOME" 
                  style="width: 100%; padding: 10px 12px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 14px; box-sizing: border-box; background-color: #f9fafb;"
                  oninput="this.value = this.value.replace(/[^a-zA-ZÀ-ú ]+/g, '')"
                >
              </div>

              <div style="margin-bottom: 20px; position: relative;">
                <label for="fc-email" style="display: block; font-size: 14px; color: #374151; margin-bottom: 6px;"><strong>Email</strong></label>
                <input 
                  id="fc-email" 
                  type="email" 
                  placeholder="seuemail@exemplo.com" 
                  style="width: 100%; padding: 10px 12px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 14px; box-sizing: border-box; background-color: #f9fafb;"
                  onfocus="document.getElementById('tooltip-email').style.display = 'block'"
                  onblur="document.getElementById('tooltip-email').style.display = 'none'"
                >
                <div id="tooltip-email" style="
                  display: none;
                  position: absolute;
                  top: 100%;
                  left: 50%;
                  transform: translateX(-50%);
                  margin-top: 6px;
                  background-color: #f7f2da;
                  color: #111827;
                  padding: 8px 12px;
                  border-radius: 6px;
                  font-size: 13px;
                  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
                  z-index: 10;
                  width: 300px;
                  max-width: 300px;
                ">
                  <strong>Atenção!</strong> A resposta pode ser enviada por e-mail caso nossa equipe não esteja online.
                  Então garanta que o e-mail informado está correto e que você tenha acesso a ele!
                </div>
              </div>

              <button id="fc-submit" style="width: 100%; padding: 12px; background: #5d3e94; color: white; border: none; border-radius: 6px; font-size: 14px; font-weight: 500; cursor: pointer;">
                Iniciar Conversa
              </button>
            </div>
          </div>
        `;

        const formContainer = document.createElement('div');
        formContainer.innerHTML = formHtml;
        formContainer.style.zIndex = "2147483647"; // Máximo z-index possível
        document.body.appendChild(formContainer);

        const launcherButton = document.createElement('button');
        launcherButton.id = 'fc-custom-launcher';
        launcherButton.innerHTML = 'Chat';
        launcherButton.style.cssText = 'position: fixed; bottom: 20px; right: 20px; background: #5d3e94; color: white; border: none; border-radius: 50%; width: 60px; height: 60px; font-size: 16px; cursor: pointer; box-shadow: 0 2px 10px rgba(0,0,0,0.2); z-index: 2147483646;';
        
        // Adiciona media query para ajustar tamanho em dispositivos mobile
        const mediaQuery = window.matchMedia('(max-width: 768px)');
        function handleMobileChanges(e) {
          if (e.matches) {
            launcherButton.style.bottom = '15px';
            launcherButton.style.right = '15px';
          }
        }
        mediaQuery.addListener(handleMobileChanges);
        handleMobileChanges(mediaQuery);
        document.body.appendChild(launcherButton);

        document.getElementById('fc-custom-form').style.display = 'none';
        
        // Função para ajustar o tamanho do formulário em dispositivos mobile
        function adjustFormSize() {
          const form = document.getElementById('fc-custom-form');
          if (!form) return;
          
          if (window.innerWidth <= 768) {
            form.style.width = '85%';
            form.style.maxHeight = '80vh';
            form.style.right = '50%';
            form.style.transform = 'translateX(50%)';
            form.style.bottom = '10%';
          } else {
            form.style.width = '400px';
            form.style.maxHeight = '90vh';
            form.style.right = '20px';
            form.style.transform = 'none';
            form.style.bottom = '40px';
          }
        }
        
        window.addEventListener('resize', adjustFormSize);
        adjustFormSize();

        document.getElementById('fc-custom-launcher').addEventListener('click', function () {
          document.getElementById('fc-custom-form').style.display = 'block';
          this.style.display = 'none';
        });
        
        document.getElementById('fc-close-form').addEventListener('click', function () {
          document.getElementById('fc-custom-form').style.display = 'none';
          document.getElementById('fc-custom-launcher').style.display = 'block';
        });

        document.getElementById('fc-submit').addEventListener('click', function () {
          const nome = document.getElementById('fc-name').value.trim();
          const email = document.getElementById('fc-email').value.trim();

          if (nome && email) {
            window.fcWidget.user.setFirstName(nome);
            window.fcWidget.user.setEmail(email);

            document.getElementById('fc-custom-form').style.display = 'none';
            document.getElementById('fc-custom-launcher').style.display = 'none';

            // Adiciona um alto z-index ao widget do Freshchat quando mostrado
            const fcContainer = document.querySelector('.fc-widget-small');
            if (fcContainer) {
              fcContainer.style.zIndex = "2147483647";
            }

            window.fcWidget.show();
            window.fcWidget.open();
          } else {
            let errorMsg = document.getElementById('fc-error-msg');
            if (!errorMsg) {
              errorMsg = document.createElement('p');
              errorMsg.id = 'fc-error-msg';
              errorMsg.style.cssText = 'color: red; margin-top: 10px; margin-bottom: 0;';
              document.getElementById('fc-submit').insertAdjacentElement('afterend', errorMsg);
            }
            errorMsg.textContent = 'Por favor, preencha todos os campos.';
          }
        });

        // Adiciona um observador para garantir que o widget do Freshchat tenha alto z-index quando mostrado
        const observer = new MutationObserver(function(mutations) {
          const fcContainer = document.querySelector('.fc-widget-small');
          if (fcContainer) {
            fcContainer.style.zIndex = "2147483647";
          }
        });
        
        observer.observe(document.body, { childList: true, subtree: true });
      });
    } else {
      setTimeout(initFreshchat, 500);
    }
  }

  if (document.readyState === 'complete') {
    initFreshchat();
  } else {
    window.addEventListener('load', initFreshchat);
  }
</script>
</body>
</html>





